import{d as n}from"./index-DP7dqNK5.js";const m=[{ankama_id:26584,name:"Épée du Bouftou",level:1,type:{name:"Épée"},recipe:[{item_ankama_id:289,item_subtype:"resource",quantity:10},{item_ankama_id:371,item_subtype:"resource",quantity:5}]},{ankama_id:26585,name:"Marteau du Mineur",level:10,type:{name:"Marteau"},recipe:[{item_ankama_id:442,item_subtype:"resource",quantity:15},{item_ankama_id:371,item_subtype:"resource",quantity:8}]},{ankama_id:26586,name:"Baguette Magique",level:20,type:{name:"Baguette"},recipe:[{item_ankama_id:289,item_subtype:"resource",quantity:20},{item_ankama_id:442,item_subtype:"resource",quantity:10}]}],p={289:{ankama_id:289,name:"Bois de Frêne",level:1},371:{ankama_id:371,name:"Fer",level:10},442:{ankama_id:442,name:"Cuivre",level:5}},c=()=>"/.netlify/functions/dofus-proxy",d=async e=>{if(!e||e.length<3)return[];try{const a=await n.getCachedSearchResults(e);if(a)return console.log(`🚀 Cache hit pour recherche: "${e}"`),a;console.log(`🌐 Cache miss, appel API pour: "${e}"`);const o=c();let t,s;if(t=`${o}?path=/dofus3/v1/fr/items/equipment/search&query=${encodeURIComponent(e)}&limit=10`,s=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const r=await s.json(),u=(Array.isArray(r)?r:[]).filter(l=>l.recipe&&l.recipe.length>0);return await n.cacheSearchResults(e,u),console.log(`💾 Résultats mis en cache pour: "${e}"`),u}catch(a){return console.error("Erreur API, utilisation des données de démonstration:",a.message),m.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()))}},f=async e=>{try{const a=await n.getCachedItemDetails(e);if(a)return console.log(`🚀 Cache hit pour item: ${e}`),a;console.log(`🌐 Cache miss, appel API pour item: ${e}`);const o=c();let t,s;if(t=`${o}?path=/dofus3/v1/fr/items/equipment/${e}`,s=await fetch(t),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const r=await s.json();return await n.cacheItemDetails(e,r),console.log(`💾 Item mis en cache: ${e}`),r}catch(a){throw console.error("Erreur lors de la récupération des détails:",a.message),a}},y=async(e,a)=>{try{const o=await n.getCachedMaterialDetails(e);if(o)return console.log(`🚀 Cache hit pour matériau: ${e}`),o;console.log(`🌐 Cache miss, appel API pour matériau: ${e}`);const t=c();let s,r;if(s=`${t}?path=/dofus3/v1/fr/items/${a}/${e}`,r=await fetch(s),!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const i=await r.json();return await n.cacheMaterialDetails(e,i),console.log(`💾 Matériau mis en cache: ${e}`),i}catch(o){console.error("Erreur matériau, utilisation des données de démonstration:",o.message);const t=p[e];return t||{ankama_id:e,name:`Matériau ${e}`,level:1}}};export{f as getItemDetails,y as getMaterialDetails,d as searchItems};
